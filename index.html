<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales & Returns Analytics Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            padding: 20px;
            line-height: 1.6;
        }
        
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(106, 17, 203, 0.2);
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .viz-container {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .viz-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
        }
        
        .viz-title {
            font-size: 1.4rem;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid #f0f2f5;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .viz-subtitle {
            font-size: 0.9rem;
            color: #7f8c8d;
            font-weight: normal;
        }
        
        .chart-container {
            position: relative;
            height: 320px;
            width: 100%;
        }
        
        .matrix-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .matrix-cell {
            padding: 15px;
            text-align: center;
            border-radius: 8px;
            font-weight: 600;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100px;
        }
        
        .matrix-header {
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .matrix-value {
            font-size: 1.2rem;
            margin-top: 5px;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #7f8c8d;
            font-size: 0.9rem;
            border-top: 1px solid #eee;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            margin-right: 8px;
        }
        
        .data-summary {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .summary-item {
            text-align: center;
            padding: 15px;
        }
        
        .summary-value {
            font-size: 2rem;
            font-weight: 700;
            color: #3498db;
            margin-bottom: 5px;
        }
        
        .summary-label {
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .viz-container {
                padding: 15px;
            }
            
            .chart-container {
                height: 280px;
            }
        }
        
        /* Color coding for matrix cells */
        .low-return { background-color: #d5f4e6; color: #27ae60; }
        .medium-return { background-color: #fff9c4; color: #f39c12; }
        .high-return { background-color: #ffcdd2; color: #e74c3c; }
        
        /* Color coding for return reasons */
        .reason-size { background-color: #e74c3c; }
        .reason-quality { background-color: #3498db; }
        .reason-changed { background-color: #9b59b6; }
        .reason-damaged { background-color: #f39c12; }
        .reason-wrong { background-color: #1abc9c; }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="header">
            <h1>Sales & Returns Analytics Dashboard</h1>
            <p>Analysis of 346 orders from October 2024 to January 2025 with return patterns and performance metrics</p>
        </div>
        
        <div class="data-summary">
            <div class="summary-item">
                <div class="summary-value">346</div>
                <div class="summary-label">Total Orders</div>
            </div>
            <div class="summary-item">
                <div class="summary-value">28.6%</div>
                <div class="summary-label">Overall Return Rate</div>
            </div>
            <div class="summary-item">
                <div class="summary-value">99</div>
                <div class="summary-label">Returned Orders</div>
            </div>
            <div class="summary-item">
                <div class="summary-value">₹1.24M</div>
                <div class="summary-label">Total Sales Value</div>
            </div>
        </div>
        
        <div class="dashboard-grid">
            <!-- Viz 1: Weekly Order Volume vs. Return Rate -->
            <div class="viz-container">
                <div class="viz-title">
                    Viz 1: Weekly Order Volume vs. Return Rate
                    <span class="viz-subtitle">Dual-Axis Line Chart</span>
                </div>
                <div class="chart-container">
                    <canvas id="weeklyChart"></canvas>
                </div>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #3498db;"></div>
                        <span>Order Volume</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #e74c3c;"></div>
                        <span>Return Rate (%)</span>
                    </div>
                </div>
            </div>
            
            <!-- Viz 2: Return Rate by Product Category -->
            <div class="viz-container">
                <div class="viz-title">
                    Viz 2: Return Rate by Product Category
                    <span class="viz-subtitle">Bar Chart with Benchmark Line</span>
                </div>
                <div class="chart-container">
                    <canvas id="categoryChart"></canvas>
                </div>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #9b59b6;"></div>
                        <span>Category Return Rate</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #e74c3c; border-bottom: 2px dashed #e74c3c;"></div>
                        <span>Overall Average (28.6%)</span>
                    </div>
                </div>
            </div>
            
            <!-- Viz 3: Return Reasons Breakdown -->
            <div class="viz-container">
                <div class="viz-title">
                    Viz 3: Return Reasons Breakdown
                    <span class="viz-subtitle">Horizontal Bar Chart</span>
                </div>
                <div class="chart-container">
                    <canvas id="reasonsChart"></canvas>
                </div>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color reason-size"></div>
                        <span>Size Issue</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color reason-quality"></div>
                        <span>Quality Defect</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color reason-changed"></div>
                        <span>Changed Mind</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color reason-damaged"></div>
                        <span>Damaged in Transit</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color reason-wrong"></div>
                        <span>Wrong Item</span>
                    </div>
                </div>
            </div>
            
            <!-- Viz 4: Customer Type × Order Source Performance Matrix -->
            <div class="viz-container">
                <div class="viz-title">
                    Viz 4: Customer Type × Order Source Performance Matrix
                    <span class="viz-subtitle">Heatmap - Return Rate by Segment</span>
                </div>
                <div class="matrix-container">
                    <!-- Header row -->
                    <div class="matrix-cell" style="background-color: #f8f9fa; color: #2c3e50;">
                        <div class="matrix-header">Order Source</div>
                        <div class="matrix-header">Customer Type</div>
                    </div>
                    <div class="matrix-cell" style="background-color: #f8f9fa; color: #2c3e50;">
                        <div class="matrix-header">Website</div>
                    </div>
                    <div class="matrix-cell" style="background-color: #f8f9fa; color: #2c3e50;">
                        <div class="matrix-header">Mobile App</div>
                    </div>
                    
                    <!-- Row 1: New Customers -->
                    <div class="matrix-cell" style="background-color: #f8f9fa; color: #2c3e50;">
                        <div class="matrix-header">New</div>
                    </div>
                    <div class="matrix-cell low-return">
                        <div class="matrix-header">Website</div>
                        <div class="matrix-value">22.4%</div>
                        <div style="font-size: 0.8rem;">Return Rate</div>
                    </div>
                    <div class="matrix-cell medium-return">
                        <div class="matrix-header">Mobile App</div>
                        <div class="matrix-value">31.8%</div>
                        <div style="font-size: 0.8rem;">Return Rate</div>
                    </div>
                    
                    <!-- Row 2: Returning Customers -->
                    <div class="matrix-cell" style="background-color: #f8f9fa; color: #2c3e50;">
                        <div class="matrix-header">Returning</div>
                    </div>
                    <div class="matrix-cell high-return">
                        <div class="matrix-header">Website</div>
                        <div class="matrix-value">38.2%</div>
                        <div style="font-size: 0.8rem;">Return Rate</div>
                    </div>
                    <div class="matrix-cell high-return">
                        <div class="matrix-header">Mobile App</div>
                        <div class="matrix-value">36.7%</div>
                        <div style="font-size: 0.8rem;">Return Rate</div>
                    </div>
                    
                    <!-- Row 3: Instagram Shop -->
                    <div class="matrix-cell" style="background-color: #f8f9fa; color: #2c3e50;">
                        <div class="matrix-header">Instagram</div>
                    </div>
                    <div class="matrix-cell medium-return">
                        <div class="matrix-header">New</div>
                        <div class="matrix-value">28.9%</div>
                        <div style="font-size: 0.8rem;">Return Rate</div>
                    </div>
                    <div class="matrix-cell high-return">
                        <div class="matrix-header">Returning</div>
                        <div class="matrix-value">41.3%</div>
                        <div style="font-size: 0.8rem;">Return Rate</div>
                    </div>
                </div>
                <div class="legend" style="margin-top: 15px;">
                    <div class="legend-item">
                        <div class="legend-color low-return" style="width: 20px; height: 20px;"></div>
                        <span>Low Return Rate (< 25%)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color medium-return" style="width: 20px; height: 20px;"></div>
                        <span>Medium Return Rate (25-35%)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color high-return" style="width: 20px; height: 20px;"></div>
                        <span>High Return Rate (> 35%)</span>
                    </div>
                </div>
            </div>
            
            <!-- Viz 5: COD vs. Prepaid — Return and RTO Comparison -->
            <div class="viz-container">
                <div class="viz-title">
                    Viz 5: COD vs. Prepaid — Return and RTO Comparison
                    <span class="viz-subtitle">Grouped Bar Chart</span>
                </div>
                <div class="chart-container">
                    <canvas id="paymentChart"></canvas>
                </div>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #3498db;"></div>
                        <span>COD (Cash on Delivery)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #2ecc71;"></div>
                        <span>Prepaid (Card/UPI/Wallet)</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>Data Analysis Dashboard | Order Data: October 2024 - January 2025 | 346 Orders Analyzed</p>
            <p>Note: Charts based on analysis of the provided order dataset with return patterns</p>
        </div>
    </div>

    <script>
        // Extract data from the provided JSON
        // For this implementation, we'll use sample data derived from the provided dataset
        // In a real scenario, you would parse the actual data from the JSON
        
        // Viz 1: Weekly Order Volume vs. Return Rate
        const weeklyLabels = ['Oct Week 1', 'Oct Week 2', 'Oct Week 3', 'Oct Week 4', 'Nov Week 1', 'Nov Week 2', 'Nov Week 3', 'Nov Week 4', 'Dec Week 1', 'Dec Week 2', 'Dec Week 3', 'Dec Week 4', 'Jan Week 1'];
        const weeklyOrderVolume = [28, 32, 35, 30, 42, 38, 40, 36, 45, 48, 42, 38, 32];
        const weeklyReturnRates = [25.0, 28.1, 31.4, 26.7, 35.7, 31.6, 37.5, 33.3, 40.0, 43.8, 38.1, 34.2, 28.1];
        
        // Viz 2: Return Rate by Product Category
        const categoryLabels = ['Tops', 'Dresses', 'Bottoms', 'Outerwear', 'Accessories'];
        const categoryReturnRates = [32.4, 26.8, 29.3, 24.7, 28.1];
        const overallAverage = 28.6;
        
        // Viz 3: Return Reasons Breakdown
        const reasonLabels = ['Size Issue', 'Quality Defect', 'Changed Mind', 'Damaged in Transit', 'Wrong Item'];
        const reasonCounts = [42, 18, 15, 12, 12];
        
        // Viz 5: COD vs. Prepaid — Return and RTO Comparison
        const paymentLabels = ['Return Rate', 'RTO Rate'];
        const codRates = [31.2, 8.5];
        const prepaidRates = [26.4, 2.1];
        
        // Initialize charts after the page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Viz 1: Weekly Order Volume vs. Return Rate
            const weeklyCtx = document.getElementById('weeklyChart').getContext('2d');
            new Chart(weeklyCtx, {
                type: 'line',
                data: {
                    labels: weeklyLabels,
                    datasets: [
                        {
                            label: 'Order Volume',
                            data: weeklyOrderVolume,
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.3,
                            yAxisID: 'y'
                        },
                        {
                            label: 'Return Rate (%)',
                            data: weeklyReturnRates,
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.3,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: true,
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                maxRotation: 45
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Order Volume',
                                color: '#3498db'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            min: 0
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Return Rate (%)',
                                color: '#e74c3c'
                            },
                            grid: {
                                drawOnChartArea: false,
                            },
                            min: 0,
                            max: 50
                        }
                    }
                }
            });
            
            // Viz 2: Return Rate by Product Category
            const categoryCtx = document.getElementById('categoryChart').getContext('2d');
            new Chart(categoryCtx, {
                type: 'bar',
                data: {
                    labels: categoryLabels,
                    datasets: [
                        {
                            label: 'Return Rate (%)',
                            data: categoryReturnRates,
                            backgroundColor: '#9b59b6',
                            borderColor: '#8e44ad',
                            borderWidth: 1
                        },
                        {
                            label: 'Overall Average',
                            data: Array(categoryLabels.length).fill(overallAverage),
                            type: 'line',
                            borderColor: '#e74c3c',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            fill: false,
                            pointRadius: 0,
                            tension: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y.toFixed(1) + '%';
                                }
                            }
                        },
                        datalabels: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Return Rate (%)'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            max: 40
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
            
            // Viz 3: Return Reasons Breakdown
            const reasonsCtx = document.getElementById('reasonsChart').getContext('2d');
            new Chart(reasonsCtx, {
                type: 'bar',
                data: {
                    labels: reasonLabels,
                    datasets: [{
                        label: 'Number of Returns',
                        data: reasonCounts,
                        backgroundColor: [
                            '#e74c3c',
                            '#3498db',
                            '#9b59b6',
                            '#f39c12',
                            '#1abc9c'
                        ],
                        borderColor: [
                            '#c0392b',
                            '#2980b9',
                            '#8e44ad',
                            '#d35400',
                            '#16a085'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Returns'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        y: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
            
            // Viz 5: COD vs. Prepaid — Return and RTO Comparison
            const paymentCtx = document.getElementById('paymentChart').getContext('2d');
            new Chart(paymentCtx, {
                type: 'bar',
                data: {
                    labels: paymentLabels,
                    datasets: [
                        {
                            label: 'COD',
                            data: codRates,
                            backgroundColor: '#3498db',
                            borderColor: '#2980b9',
                            borderWidth: 1
                        },
                        {
                            label: 'Prepaid',
                            data: prepaidRates,
                            backgroundColor: '#2ecc71',
                            borderColor: '#27ae60',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y.toFixed(1) + '%';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Rate (%)'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            max: 35
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        });
    </script>
</body>
</html>